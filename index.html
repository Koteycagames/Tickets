<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>GameZone - Tickets & Games</title>
    <style>
        :root {
            --bg: #181818;
            --panel: #242424;
            --text: #ffffff;
            --green: #2ecc71;
            --yellow: #f1c40f;
            --red: #e74c3c;
            --blue: #3498db;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* –®–ê–ü–ö–ê */
        header {
            background-color: var(--panel);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .logo { font-size: 24px; font-weight: 900; letter-spacing: 1px; color: var(--blue); }
        
        .profile-section {
            display: flex;
            align-items: center;
            gap: 20px;
            cursor: pointer;
            background: #2a2a2a;
            padding: 5px 15px;
            border-radius: 50px;
            transition: 0.2s;
        }
        .profile-section:hover { background: #333; }

        .balance-box { 
            font-weight: bold; 
            color: var(--yellow); 
            display: flex; 
            align-items: center; 
            gap: 5px; 
        }

        /* –ê–í–ê–¢–ê–†–ö–ê –ë–£–ö–í–û–ô */
        .avatar-circle {
            width: 40px;
            height: 40px;
            background: var(--blue);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            font-weight: bold;
            color: white;
            text-transform: uppercase;
        }

        /* –ú–ï–ù–Æ */
        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .action-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            font-size: 14px;
            transition: transform 0.1s;
        }
        button:active { transform: scale(0.95); }
        .btn-reward { background: linear-gradient(45deg, #e67e22, #f1c40f); color: #000; }
        .btn-game { background: var(--panel); color: white; border: 1px solid #444; }
        .btn-green { background: var(--green); color: white; }
        .btn-danger { background: var(--red); color: white; }

        /* –°–ü–ò–°–û–ö –ò–ì–† */
        h2 { border-left: 5px solid var(--blue); padding-left: 10px; margin-bottom: 20px; }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .game-card {
            background: var(--panel);
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.2s;
            cursor: pointer;
            position: relative;
        }
        .game-card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        .game-thumb { height: 120px; background: #444; display: flex; align-items: center; justify-content: center; font-size: 40px; }
        .game-info { padding: 15px; }
        .game-title { font-weight: bold; margin-bottom: 5px; display: block; }
        .play-btn { 
            margin-top: 10px; 
            width: 100%; 
            background: var(--green); 
            color: white; 
            padding: 8px; 
            border-radius: 5px; 
            text-align: center;
            display: block;
        }

        /* –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        .modal-window {
            background: var(--panel);
            width: 450px;
            padding: 25px;
            border-radius: 15px;
            position: relative;
            text-align: center;
            border: 1px solid #444;
            max-height: 90vh;
            overflow-y: auto;
        }
        .close-btn { position: absolute; top: 15px; right: 20px; font-size: 24px; cursor: pointer; color: #888; }
        
        input {
            width: 80%;
            padding: 10px;
            margin: 10px 0;
            background: #111;
            border: 1px solid #444;
            color: white;
            border-radius: 5px;
        }

        /* 3D –ú–û–ù–ï–¢–ö–ê */
        .coin-scene {
            width: 150px;
            height: 150px;
            margin: 30px auto;
            perspective: 1000px;
        }
        .coin {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .coin-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 40px;
            border: 8px solid #d4af37;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
        }
        .face-front { background: #f1c40f; transform: rotateY(0deg); color: #9e8206; }
        .face-back { background: #bdc3c7; transform: rotateY(180deg); color: #7f8c8d; border-color: #95a5a6; }

        /* –°–ü–ò–°–û–ö –ù–ê–ì–†–ê–î */
        .reward-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #1a1a1a;
            margin: 8px 0;
            padding: 10px 15px;
            border-radius: 8px;
            text-align: left;
        }
        .reward-info { font-size: 14px; }
        .reward-timer { font-size: 12px; color: #777; }

        /* –û–ö–ù–û –ò–ì–†–´ */
        .game-frame {
            width: 100%;
            height: 300px;
            background: black;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #555;
            border-radius: 10px;
            margin-bottom: 20px;
            flex-direction: column;
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">MiniGames<span style="color:var(--yellow)">Hub</span></div>
        
        <div class="profile-section" onclick="openModal('modalProfile')">
            <div class="balance-box">
                <span id="balanceDisplay">15</span> üéüÔ∏è
            </div>
            <div class="avatar-circle" id="headerAvatar">?</div>
        </div>
    </header>

    <div class="main-content">
        <div class="action-bar">
            <button class="btn-reward" onclick="openModal('modalRewards')">
                ‚è≥ –ù–∞–≥—Ä–∞–¥—ã –∑–∞ –≤—Ä–µ–º—è (<span id="globalTimer">00:00</span>)
            </button>
            <button class="btn-game" onclick="openModal('modalCoin')">
                ü™ô –ü–æ–¥–±—Ä–æ—Å–∏—Ç—å –º–æ–Ω–µ—Ç–∫—É
            </button>
        </div>

        <h2>–ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä</h2>
        <div class="games-grid" id="gamesContainer">
            </div>
    </div>

    <div class="modal-overlay" id="modalProfile">
        <div class="modal-window">
            <span class="close-btn" onclick="closeModal('modalProfile')">&times;</span>
            <h2>–ú–æ–π –ü—Ä–æ—Ñ–∏–ª—å</h2>
            <div class="avatar-circle" id="profileAvatar" style="width:80px; height:80px; font-size:40px; margin: 0 auto 15px;">?</div>
            <p id="profileEmail" style="color: #888; margin-bottom: 20px;">email@example.com</p>
            
            <div style="background: #111; padding: 15px; border-radius: 10px; text-align: left;">
                <h3 style="margin-top:0">–ü–µ—Ä–µ–≤–æ–¥ –¢–∏–∫–µ—Ç–æ–≤</h3>
                <input type="text" id="transferNick" placeholder="–ù–∏–∫–Ω–µ–π–º –∏–≥—Ä–æ–∫–∞">
                <input type="number" id="transferAmount" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ">
                <button class="btn-green" style="width:100%" onclick="transferMoney()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å ‚û°</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="modalRewards">
        <div class="modal-window">
            <span class="close-btn" onclick="closeModal('modalRewards')">&times;</span>
            <h2>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ù–∞–≥—Ä–∞–¥—ã</h2>
            <p style="color:#888">–¢—ã –æ–Ω–ª–∞–π–Ω: <span id="rewardsTimerDisplay">00:00</span></p>
            <div id="rewardsListContainer">
                </div>
        </div>
    </div>

    <div class="modal-overlay" id="modalCoin">
        <div class="modal-window">
            <span class="close-btn" onclick="closeModal('modalCoin')">&times;</span>
            <h2>–û—Ä–µ–ª –∏–ª–∏ –†–µ—à–∫–∞</h2>
            
            <div class="coin-scene">
                <div class="coin" id="coinObj">
                    <div class="coin-face face-front">O</div>
                    <div class="coin-face face-back">P</div>
                </div>
            </div>

            <p id="coinStatus" style="font-weight:bold; font-size: 18px;">–°–¥–µ–ª–∞–π —Å—Ç–∞–≤–∫—É!</p>
            
            <div style="background:#222; padding:10px; border-radius:8px; margin-bottom:15px;">
                <span style="color:var(--yellow)">–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∫–∏–¥–∫–∏: <b id="freeFlipsDisplay">0</b></span>
            </div>

            <input type="number" id="betInput" placeholder="–°—Ç–∞–≤–∫–∞ (Tickets)" value="5">
            
            <div style="display:flex; gap:10px; justify-content:center;">
                <button class="btn-game" style="flex:1; background:#f1c40f; color:#000;" onclick="playCoin('heads')">–û–†–ï–õ</button>
                <button class="btn-game" style="flex:1; background:#95a5a6; color:#000;" onclick="playCoin('tails')">–†–ï–®–ö–ê</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="modalGameWindow">
        <div class="modal-window" style="width: 800px; height: 600px;">
            <span class="close-btn" onclick="closeModal('modalGameWindow'); stopGameSession();">&times;</span>
            <h2 id="activeGameTitle">Game Title</h2>
            <div class="game-frame" id="gameFrame">
                <div id="gameLoader">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä—ã...</div>
            </div>
            <p>–í—ã –∏–≥—Ä–∞–µ—Ç–µ. –í—Ä–µ–º—è –∏–≥—Ä—ã –∑–∞—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ –Ω–∞–≥—Ä–∞–¥—ã.</p>
            <button class="btn-danger" onclick="closeModal('modalGameWindow')">–í—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã</button>
        </div>
    </div>

    <script>
        /* --- –î–ê–ù–ù–´–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø --- */
        let user = JSON.parse(localStorage.getItem('siteUser')) || {
            email: "admin@gmail.com", // –ü—Ä–∏–º–µ—Ä –ø–æ—á—Ç—ã
            tickets: 15, // –°–¢–ê–†–¢: 15 –¢–ò–ö–ï–¢–û–í
            playTime: 0,
            freeFlips: 0,
            claimed: []
        };

        // –ö–æ–Ω—Ñ–∏–≥ –Ω–∞–≥—Ä–∞–¥ (–¢–≤–æ–π —Å–ø–∏—Å–æ–∫)
        const rewardsDB = [
            { m: 1,  type: 'T', val: 3,  desc: "1 –º–∏–Ω—É—Ç–∞: 3 Tickets" },
            { m: 5,  type: 'T', val: 5,  desc: "5 –º–∏–Ω—É—Ç: 5 Tickets" },
            { m: 10, type: 'F', val: 3,  desc: "10 –º–∏–Ω—É—Ç: 3 Free Flips" },
            { m: 15, type: 'T', val: 8,  desc: "15 –º–∏–Ω—É—Ç: 8 Tickets" },
            { m: 20, type: 'F', val: 1,  desc: "20 –º–∏–Ω—É—Ç: 1 Free Flip" },
            { m: 30, type: 'T', val: 10, desc: "30 –º–∏–Ω—É—Ç: 10 Tickets" },
            { m: 60, type: 'F', val: 10, desc: "60 –º–∏–Ω—É—Ç: 10 Free Flips" }
        ];

        /* --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø --- */
        window.onload = function() {
            setupProfile();
            updateBalanceUI();
            renderGames();
            renderRewardsUI();
            
            // –¢–∞–π–º–µ—Ä (—Ç–∏–∫–∞–µ—Ç –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É)
            setInterval(() => {
                user.playTime++;
                save();
                updateTimerDisplay();
                checkRewardUnlock(); 
            }, 1000);
        };

        function save() { localStorage.setItem('siteUser', JSON.stringify(user)); }

        function setupProfile() {
            // –ê–≤–∞—Ç–∞—Ä–∫–∞: –ü–µ—Ä–≤–∞—è –±—É–∫–≤–∞ –ø–æ—á—Ç—ã
            const letter = user.email.charAt(0).toUpperCase();
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ü–≤–µ—Ç–∞ –ø–æ –±—É–∫–≤–µ
            const hue = letter.charCodeAt(0) * 45; 
            const color = `hsl(${hue}, 70%, 50%)`;

            document.getElementById('headerAvatar').innerText = letter;
            document.getElementById('headerAvatar').style.background = color;
            
            document.getElementById('profileAvatar').innerText = letter;
            document.getElementById('profileAvatar').style.background = color;
            document.getElementById('profileEmail').innerText = user.email;
        }

        function updateBalanceUI() {
            document.getElementById('balanceDisplay').innerText = user.tickets;
            document.getElementById('freeFlipsDisplay').innerText = user.freeFlips;
        }

        function updateTimerDisplay() {
            const m = Math.floor(user.playTime / 60);
            const s = user.playTime % 60;
            const str = `${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
            document.getElementById('globalTimer').innerText = str;
            document.getElementById('rewardsTimerDisplay').innerText = str;
        }

        /* --- –õ–û–ì–ò–ö–ê –ù–ê–ì–†–ê–î --- */
        function renderRewardsUI() {
            const list = document.getElementById('rewardsListContainer');
            list.innerHTML = "";

            rewardsDB.forEach((r, index) => {
                const row = document.createElement('div');
                row.className = "reward-row";
                
                const isClaimed = user.claimed.includes(index);
                const isUnlocked = user.playTime >= r.m * 60;

                let btnHTML;
                if(isClaimed) {
                    btnHTML = `<span style="color:#555">‚úî –ü–æ–ª—É—á–µ–Ω–æ</span>`;
                } else if(isUnlocked) {
                    btnHTML = `<button class="btn-green" style="padding:5px 10px; font-size:12px;" onclick="claim(${index})">–ó–∞–±—Ä–∞—Ç—å</button>`;
                } else {
                    const left = (r.m * 60) - user.playTime;
                    btnHTML = `<span class="reward-timer">—á–µ—Ä–µ–∑ ${Math.ceil(left/60)} –º–∏–Ω</span>`;
                }

                row.innerHTML = `
                    <div class="reward-info">${r.desc}</div>
                    <div>${btnHTML}</div>
                `;
                list.appendChild(row);
            });
        }

        function checkRewardUnlock() {
            // –ü—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ–º UI –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ –æ–∫–Ω–æ –Ω–∞–≥—Ä–∞–¥
            if(document.getElementById('modalRewards').style.display === 'flex') {
                renderRewardsUI();
            }
        }

        function claim(index) {
            const r = rewardsDB[index];
            if(r.type === 'T') {
                user.tickets += r.val;
                alert(`+${r.val} Tickets!`);
            } else {
                user.freeFlips += r.val;
                alert(`+${r.val} Free Flips!`);
            }
            user.claimed.push(index);
            save();
            updateBalanceUI();
            renderRewardsUI();
        }

        /* --- –õ–û–ì–ò–ö–ê –ü–ï–†–ï–í–û–î–ê --- */
        function transferMoney() {
            const nick = document.getElementById('transferNick').value;
            const amount = parseInt(document.getElementById('transferAmount').value);

            if(!nick) return alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫!");
            if(isNaN(amount) || amount <= 0) return alert("–ù–µ–≤–µ—Ä–Ω–∞—è —Å—É–º–º–∞");
            if(user.tickets < amount) return alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–∏–∫–µ—Ç–æ–≤!");

            user.tickets -= amount;
            save();
            updateBalanceUI();
            alert(`–£—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ ${amount} —Ç–∏–∫–µ—Ç–æ–≤ –∏–≥—Ä–æ–∫—É ${nick}`);
            closeModal('modalProfile');
        }

        /* --- –õ–û–ì–ò–ö–ê –ú–û–ù–ï–¢–ö–ò (3D) --- */
        let isFlipping = false;

        function playCoin(choice) {
            if(isFlipping) return;

            const betInput = document.getElementById('betInput');
            let bet = parseInt(betInput.value);
            let useFree = false;

            // –õ–æ–≥–∏–∫–∞ –æ–ø–ª–∞—Ç—ã
            if(user.freeFlips > 0) {
                if(confirm(`–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–∏–¥–æ–∫? (–û—Å—Ç–∞–ª–æ—Å—å: ${user.freeFlips})`)) {
                    useFree = true;
                    bet = 0;
                }
            }

            if(!useFree) {
                if(isNaN(bet) || bet <= 0) return alert("–°—Ç–∞–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –±–æ–ª—å—à–µ 0");
                if(user.tickets < bet) return alert("–ú–∞–ª–æ —Ç–∏–∫–µ—Ç–æ–≤!");
                user.tickets -= bet;
            } else {
                user.freeFlips--;
            }

            updateBalanceUI();
            isFlipping = true;
            document.getElementById('coinStatus').innerText = "–ú–æ–Ω–µ—Ç–∫–∞ –ª–µ—Ç–∏—Ç...";

            // –†–∞–Ω–¥–æ–º
            const isHeads = Math.random() < 0.5; // true = –û—Ä–µ–ª
            const resultSide = isHeads ? 'heads' : 'tails';

            // –ê–Ω–∏–º–∞—Ü–∏—è
            const coinObj = document.getElementById('coinObj');
            coinObj.style.transition = "none";
            coinObj.style.transform = "rotateY(0deg)";

            setTimeout(() => {
                coinObj.style.transition = "transform 3s cubic-bezier(0.175, 0.885, 0.32, 1.275)";
                // –í—Ä–∞—â–∞–µ–º —Å–∏–ª—å–Ω–æ (1800deg = 5 –æ–±–æ—Ä–æ—Ç–æ–≤) + –Ω—É–∂–Ω–∞—è –≥—Ä–∞–Ω—å
                // –û—Ä–µ–ª = 0/360, –†–µ—à–∫–∞ = 180
                const rotate = 1800 + (isHeads ? 0 : 180);
                coinObj.style.transform = `rotateY(${rotate}deg)`;
            }, 50);

            setTimeout(() => {
                // –†–µ–∑—É–ª—å—Ç–∞—Ç
                const win = (choice === resultSide);
                
                if(win) {
                    let winSum = useFree ? 5 : bet * 2; // –ï—Å–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ - –ø—Ä–∏–∑ 5, –∏–Ω–∞—á–µ —Ö2
                    user.tickets += winSum;
                    document.getElementById('coinStatus').innerHTML = `<span style="color:var(--green)">–ü–û–ë–ï–î–ê! +${winSum}</span>`;
                } else {
                    document.getElementById('coinStatus').innerHTML = `<span style="color:var(--red)">–ü–†–û–ò–ì–†–´–®</span>`;
                }
                
                save();
                updateBalanceUI();
                isFlipping = false;
            }, 3050);
        }

        /* --- –ò–ì–†–´ --- */
        function renderGames() {
            const games = [
                { name: "Parkour Tower", img: "üèÉ‚Äç‚ôÇÔ∏è" },
                { name: "Pixel Shooter", img: "üî´" },
                { name: "Speed Race", img: "üèéÔ∏è" },
                { name: "Build Tycoon", img: "üèóÔ∏è" },
                { name: "Space Sim", img: "üöÄ" }
            ];

            const cont = document.getElementById('gamesContainer');
            games.forEach(g => {
                const el = document.createElement('div');
                el.className = 'game-card';
                el.onclick = () => openGame(g.name, g.img);
                el.innerHTML = `
                    <div class="game-thumb" style="background:${getRandomColor()}">${g.img}</div>
                    <div class="game-info">
                        <span class="game-title">${g.name}</span>
                        <span style="font-size:12px; color:#777">üë• ${Math.floor(Math.random()*5000)} playing</span>
                    </div>
                `;
                cont.appendChild(el);
            });
        }

        function openGame(title, icon) {
            document.getElementById('activeGameTitle').innerText = title;
            document.getElementById('gameLoader').innerHTML = `
                <div style="font-size:50px">${icon}</div>
                <br>–ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã...<br>
                <small>–°–≤—è–∑—å —Å —Å–µ—Ä–≤–µ—Ä–æ–º...</small>
            `;
            openModal('modalGameWindow');
        }
        
        function stopGameSession() {
            // –¢—É—Ç –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏–≥—Ä—ã
        }

        function getRandomColor() {
            const c = ['#c0392b', '#8e44ad', '#2980b9', '#16a085', '#d35400'];
            return c[Math.floor(Math.random() * c.length)];
        }

        /* --- –•–ï–õ–ü–ï–†–´ –ú–û–î–ê–õ–û–ö --- */
        function openModal(id) { 
            document.getElementById(id).style.display = 'flex'; 
            if(id === 'modalRewards') renderRewardsUI();
        }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
    </script>
</body>
</html>
